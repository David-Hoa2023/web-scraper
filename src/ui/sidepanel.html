<!DOCTYPE html>
<html lang="en" class="dark">

<head>
  <meta charset="UTF-8">
  <title>Scraper Pro</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&display=swap"
    rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap"
    rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
</head>

<body>
  <div class="app-container">
    <!-- Sidebar -->
    <aside class="sidebar">
      <div class="logo-area">
        <div class="logo-icon-wrapper">
          <span class="material-symbols-outlined logo-icon">terminal</span>
        </div>
        <div>
          <h1 class="logo-text">Scraper Pro</h1>
          <p class="logo-subtitle">Developer Tools</p>
        </div>
      </div>

      <!-- Master ON/OFF Toggle -->
      <div class="extension-toggle-container">
        <div class="extension-toggle-row">
          <span class="extension-status" id="extension-status">Active</span>
          <label class="switch">
            <input type="checkbox" id="extension-enabled" checked>
            <span class="slider"></span>
          </label>
        </div>
      </div>

      <nav class="nav-menu">
        <button class="nav-item active" data-tab="dashboard" id="nav-dashboard">
          <span class="material-symbols-outlined">dashboard</span>
          <span>Dashboard</span>
        </button>
        <button class="nav-item" data-tab="arbitrage" id="nav-arbitrage">
          <span class="material-symbols-outlined">trending_up</span>
          <span>Arbitrage</span>
        </button>
        <button class="nav-item" data-tab="match" id="nav-match">
          <span class="material-symbols-outlined">hub</span>
          <span>Match Strategy</span>
        </button>
        <button class="nav-item" data-tab="extract" id="nav-extract">
          <span class="material-symbols-outlined">database</span>
          <span>Extraction</span>
        </button>
        <button class="nav-item" data-tab="history" id="nav-history">
          <span class="material-symbols-outlined">history</span>
          <span>History</span>
        </button>
        <button class="nav-item" data-tab="templates" id="nav-templates">
          <span class="material-symbols-outlined">content_copy</span>
          <span>Templates</span>
        </button>
        <button class="nav-item" data-tab="settings" id="nav-settings">
          <span class="material-symbols-outlined">settings</span>
          <span>Settings</span>
        </button>
      </nav>

      <div class="sidebar-footer">
        <div class="usage-box">
          <p class="usage-label">Usage Limit</p>
          <div class="usage-bar">
            <div class="usage-fill" id="usage-fill" style="width: 65%"></div>
          </div>
          <p class="usage-text"><span id="usage-current">650</span> / <span id="usage-max">1000</span> requests</p>
        </div>
      </div>
    </aside>

    <!-- Main Content -->
    <main class="content-area custom-scrollbar">

      <!-- Dashboard Tab -->
      <div id="tab-dashboard" class="tab-pane active">
        <header class="dashboard-header">
          <div>
            <h2>Dashboard</h2>
            <p class="subtitle">Monitor and manage your scraping tasks.</p>
          </div>
          <button class="btn-secondary" id="create-task-btn">
            <span class="material-symbols-outlined" style="font-size: 16px; margin-right: 4px;">add</span>
            New Task
          </button>
        </header>

        <div class="stats-overview stats-3col">
          <div class="stat-card">
            <div class="stat-header">
              <span class="stat-label">Total Tasks</span>
              <span class="material-symbols-outlined stat-icon">assignment</span>
            </div>
            <span class="stat-value" id="total-tasks">0</span>
            <span class="stat-trend">
              <span class="material-symbols-outlined" style="font-size: 12px;">trending_up</span>
              <span id="tasks-trend">+0 this week</span>
            </span>
          </div>
          <div class="stat-card">
            <div class="stat-header">
              <span class="stat-label">Success Rate</span>
              <span class="material-symbols-outlined stat-icon">check_circle</span>
            </div>
            <span class="stat-value" id="success-rate">0%</span>
            <span class="stat-trend">
              <span class="material-symbols-outlined" style="font-size: 12px;">trending_up</span>
              <span id="success-trend">+0%</span>
            </span>
          </div>
          <div class="stat-card">
            <div class="stat-header">
              <span class="stat-label">Items Collected</span>
              <span class="material-symbols-outlined stat-icon">database</span>
            </div>
            <span class="stat-value" id="items-count">0</span>
            <span class="stat-trend">
              <span class="material-symbols-outlined" style="font-size: 12px;">trending_up</span>
              <span id="items-trend">+0 today</span>
            </span>
          </div>
        </div>

        <!-- Saved URLs Section -->
        <div class="saved-urls-section" style="margin-top: 16px;">
          <div class="saved-urls-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
            <h3 style="margin: 0; font-size: 14px; font-weight: 600;">Saved URLs</h3>
            <button id="add-current-url-btn" class="btn-text" title="Save current page URL">
              <span class="material-symbols-outlined" style="font-size: 16px;">add_link</span>
            </button>
          </div>
          <div id="saved-urls-list" class="saved-urls-list custom-scrollbar" style="max-height: 150px; overflow-y: auto;">
            <div class="saved-url-empty" style="text-align: center; padding: 16px; color: var(--color-text-muted); font-size: 12px;">
              <span class="material-symbols-outlined" style="font-size: 24px; display: block; margin-bottom: 4px;">bookmark_border</span>
              No saved URLs yet. Right-click any page and select "Save to Scraping List".
            </div>
          </div>
        </div>

        <div class="hero-actions">
          <button id="main-action-btn" class="btn-primary">
            <span class="material-symbols-outlined">play_arrow</span>
            Start Scanning
          </button>
        </div>

        <div class="status-badge" id="status-badge">
          <span class="dot active" id="status-dot"></span>
          <span id="status-text">System Ready</span>
        </div>

        <div class="log-section" style="margin-top: 16px;">
          <div class="log-header">
            <h3>Recent Activity</h3>
            <button id="clear-log-btn" class="btn-text">Clear</button>
          </div>
          <div class="log-list custom-scrollbar" id="activity-log">
            <div class="log-item">
              <span class="time">--:--</span>
              <span class="msg">Waiting for activity...</span>
            </div>
          </div>
        </div>

        <!-- Live Preview Section -->
        <div class="option-card" style="margin-top: 16px;">
          <div class="preview-header">
            <h3>Latest Capture</h3>
            <button id="toggle-preview-mode" class="btn-text" title="Toggle view mode">
              <span class="material-symbols-outlined" style="font-size: 16px;">view_list</span>
            </button>
          </div>
          <!-- Visual preview cards -->
          <div id="preview-cards" class="preview-cards custom-scrollbar">
            <div class="preview-empty">
              <span class="material-symbols-outlined" style="font-size: 32px; opacity: 0.3;">image</span>
              <span>Scraped items will appear here...</span>
            </div>
          </div>
          <!-- JSON preview (hidden by default) -->
          <div id="live-preview-content" class="custom-scrollbar" style="
            display: none;
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-sm);
            padding: 12px;
            font-family: 'JetBrains Mono', 'Monaco', monospace;
            font-size: 11px;
            color: var(--color-primary);
            max-height: 200px;
            overflow-y: auto;
            white-space: pre-wrap;
          ">// Data will appear here...</div>
        </div>

        <!-- Scheduled Tasks Table -->
        <div class="tasks-section" style="margin-top: 16px;">
          <div class="section-header" style="margin-bottom: 12px;">
            <h3
              style="font-size: 12px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.5px; color: var(--color-text-muted);">
              Scheduled Tasks</h3>
          </div>
          <div class="option-card" style="padding: 0; overflow: hidden;">
            <table class="data-table">
              <thead>
                <tr>
                  <th>Task</th>
                  <th>Status</th>
                  <th>Frequency</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody id="tasks-table-body">
                <tr>
                  <td colspan="4" class="empty-placeholder">No scheduled tasks</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>

      <!-- Arbitrage Tab -->
      <div id="tab-arbitrage" class="tab-pane">
        <header class="dashboard-header">
          <div>
            <h2>Arbitrage Scanner</h2>
            <p class="subtitle">Find profitable opportunities across platforms.</p>
          </div>
          <button class="btn-secondary" id="scan-arbitrage-btn">
            <span class="material-symbols-outlined" style="font-size: 16px; margin-right: 4px;">radar</span>
            Scan Products
          </button>
        </header>

        <!-- Platform Detection Banner -->
        <div class="platform-detection-banner" id="platform-banner" style="
          display: none;
          padding: 12px 16px;
          background: linear-gradient(135deg, var(--color-primary-alpha) 0%, transparent 100%);
          border: 1px solid var(--color-primary);
          border-radius: var(--radius-md);
          margin-bottom: 16px;
        ">
          <div style="display: flex; align-items: center; gap: 12px;">
            <span class="material-symbols-outlined" style="color: var(--color-primary); font-size: 24px;">storefront</span>
            <div>
              <p style="font-weight: 600; margin: 0;" id="platform-name">Platform Detected</p>
              <p style="font-size: 12px; color: var(--color-text-muted); margin: 4px 0 0 0;" id="platform-info">
                Ready to extract products
              </p>
            </div>
          </div>
        </div>

        <!-- Arbitrage Stats -->
        <div class="stats-overview stats-3col">
          <div class="stat-card">
            <div class="stat-header">
              <span class="stat-label">Opportunities</span>
              <span class="material-symbols-outlined stat-icon">local_offer</span>
            </div>
            <span class="stat-value" id="arb-opportunities">0</span>
            <span class="stat-trend">
              <span class="material-symbols-outlined" style="font-size: 12px;">trending_up</span>
              <span id="arb-opportunities-trend">Buy signals</span>
            </span>
          </div>
          <div class="stat-card">
            <div class="stat-header">
              <span class="stat-label">Avg Margin</span>
              <span class="material-symbols-outlined stat-icon">percent</span>
            </div>
            <span class="stat-value" id="arb-avg-margin">0%</span>
            <span class="stat-trend">
              <span class="material-symbols-outlined" style="font-size: 12px;">trending_up</span>
              <span id="arb-margin-trend">Profit potential</span>
            </span>
          </div>
          <div class="stat-card">
            <div class="stat-header">
              <span class="stat-label">Products Tracked</span>
              <span class="material-symbols-outlined stat-icon">inventory_2</span>
            </div>
            <span class="stat-value" id="arb-products">0</span>
            <span class="stat-trend">
              <span class="material-symbols-outlined" style="font-size: 12px;">trending_up</span>
              <span id="arb-products-trend">Across platforms</span>
            </span>
          </div>
        </div>

        <!-- Platform Filters -->
        <div class="option-card" style="margin-top: 16px;">
          <h3>Platforms</h3>
          <div class="platform-filters" style="display: flex; flex-wrap: wrap; gap: 8px; margin-top: 8px;">
            <label class="platform-chip active" data-platform="temu">
              <input type="checkbox" checked style="display: none;">
              <span>Temu</span>
            </label>
            <label class="platform-chip active" data-platform="shein">
              <input type="checkbox" checked style="display: none;">
              <span>Shein</span>
            </label>
            <label class="platform-chip active" data-platform="aliexpress">
              <input type="checkbox" checked style="display: none;">
              <span>AliExpress</span>
            </label>
            <label class="platform-chip active" data-platform="shopee">
              <input type="checkbox" checked style="display: none;">
              <span>Shopee</span>
            </label>
            <label class="platform-chip active" data-platform="lazada">
              <input type="checkbox" checked style="display: none;">
              <span>Lazada</span>
            </label>
            <label class="platform-chip active" data-platform="tiktokshop">
              <input type="checkbox" checked style="display: none;">
              <span>TikTok Shop</span>
            </label>
          </div>
        </div>

        <!-- Opportunities List -->
        <div class="option-card" style="margin-top: 16px; padding: 0; overflow: hidden;">
          <div style="padding: 12px 16px; border-bottom: 1px solid var(--color-border); display: flex; justify-content: space-between; align-items: center;">
            <h3 style="margin: 0;">Opportunities</h3>
            <div style="display: flex; gap: 8px;">
              <select id="arb-sort" class="form-select" style="height: 32px; font-size: 12px; padding: 0 8px;">
                <option value="margin">Sort by Margin</option>
                <option value="confidence">Sort by Confidence</option>
                <option value="date">Sort by Date</option>
              </select>
              <button id="refresh-opportunities-btn" class="btn-icon-sm" title="Refresh">
                <span class="material-symbols-outlined" style="font-size: 16px;">refresh</span>
              </button>
            </div>
          </div>
          <div id="opportunities-list" class="opportunities-list custom-scrollbar" style="max-height: 400px; overflow-y: auto;">
            <div class="empty-placeholder" style="padding: 32px; text-align: center;">
              <span class="material-symbols-outlined" style="font-size: 48px; opacity: 0.3; display: block; margin-bottom: 8px;">search_off</span>
              <p style="margin: 0; color: var(--color-text-muted);">No opportunities found yet</p>
              <p style="margin: 4px 0 0 0; font-size: 12px; color: var(--color-text-muted);">
                Navigate to a supported e-commerce site and click "Scan Products"
              </p>
            </div>
          </div>
        </div>

        <!-- Arbitrage Settings -->
        <div class="option-card" style="margin-top: 16px;">
          <h3>Settings</h3>
          <div class="input-group" style="margin-top: 12px;">
            <label style="font-size: 12px;">Minimum Profit Margin (%)</label>
            <input type="number" id="arb-min-margin" value="20" min="0" max="100" style="margin-top: 4px;">
          </div>
          <div class="option-row" style="padding: 12px 0;">
            <span>Auto-match products</span>
            <label class="switch">
              <input type="checkbox" id="arb-auto-match" checked>
              <span class="slider"></span>
            </label>
          </div>
          <div class="option-row" style="padding: 12px 0;">
            <span>Alert on new opportunities</span>
            <label class="switch">
              <input type="checkbox" id="arb-alerts" checked>
              <span class="slider"></span>
            </label>
          </div>
        </div>
      </div>

      <!-- Match Strategy Tab -->
      <div id="tab-match" class="tab-pane">
        <header class="section-header">
          <h2>Match Strategy</h2>
        </header>

        <div class="option-card">
          <h3>Pattern Matching</h3>
          <div class="option-row">
            <span>Match Tag Name</span>
            <label class="switch">
              <input type="checkbox" id="match-tag" checked>
              <span class="slider"></span>
            </label>
          </div>
          <div class="option-row">
            <span>Match Classes</span>
            <label class="switch">
              <input type="checkbox" id="match-class" checked>
              <span class="slider"></span>
            </label>
          </div>
          <div class="option-row">
            <span>Match ID</span>
            <label class="switch">
              <input type="checkbox" id="match-id">
              <span class="slider"></span>
            </label>
          </div>
          <div class="option-row">
            <span>Match Data Attributes</span>
            <label class="switch">
              <input type="checkbox" id="match-data">
              <span class="slider"></span>
            </label>
          </div>
        </div>

        <div class="option-card">
          <h3>Auto-Scroll Configuration</h3>
          <div class="input-group">
            <label>Throttle Delay (ms)</label>
            <input type="number" id="scroll-speed" value="1000" min="100" max="10000">
          </div>
          <div class="input-group">
            <label>Max Items (0 = unlimited)</label>
            <input type="number" id="max-items" value="0" min="0">
          </div>
          <div class="input-group">
            <label>Retry Count</label>
            <input type="number" id="retry-count" value="3" min="1" max="10">
          </div>
        </div>
      </div>

      <!-- Extraction Tab -->
      <div id="tab-extract" class="tab-pane">
        <header class="section-header">
          <h2>Data Extraction</h2>
          <button id="add-field-btn" class="btn-icon-sm" title="Add Field">
            <span class="material-symbols-outlined" style="font-size: 18px;">add</span>
          </button>
        </header>

        <div class="option-card">
          <h3>Extraction Options</h3>
          <div class="option-row">
            <span>Preserve Hierarchy</span>
            <label class="switch">
              <input type="checkbox" id="preserve-hierarchy">
              <span class="slider"></span>
            </label>
          </div>
          <div class="option-row">
            <span>Normalize Text</span>
            <label class="switch">
              <input type="checkbox" id="normalize-text" checked>
              <span class="slider"></span>
            </label>
          </div>
        </div>

        <div class="option-card">
          <h3>Custom Fields</h3>
          <div id="fields-list" class="scrolling-list custom-scrollbar">
            <div class="empty-placeholder">No custom fields defined</div>
          </div>
        </div>

        <div style="margin-top: 16px;">
          <div class="input-group" style="margin-bottom: 8px;">
            <label style="font-size: 12px; margin-bottom: 4px; display: block;">Export Format</label>
            <select id="export-format-selector" class="form-select" style="width: 100%; height: 36px;">
              <option value="json">JSON</option>
              <option value="csv">CSV</option>
              <option value="excel">Excel (.xlsx with Analysis)</option>
            </select>
          </div>
          <button id="export-btn" class="btn-primary">
            <span class="material-symbols-outlined">download</span>
            Export Data
          </button>
        </div>
      </div>

      <!-- History Tab -->
      <div id="tab-history" class="tab-pane">
        <header class="section-header">
          <h2>Run History</h2>
          <button id="clear-history-btn" class="btn-text">Clear All</button>
        </header>

        <div class="option-card" style="padding: 0; overflow: hidden;">
          <table class="data-table">
            <thead>
              <tr>
                <th>Task</th>
                <th>Status</th>
                <th>Items</th>
                <th>Time</th>
              </tr>
            </thead>
            <tbody id="history-table-body">
              <tr>
                <td colspan="4" class="empty-placeholder">No history yet</td>
              </tr>
            </tbody>
          </table>
          <div class="pagination">
            <span class="pagination-info" id="history-pagination-info">Showing 0 of 0</span>
            <div class="pagination-buttons">
              <button class="pagination-btn" id="history-prev-btn" disabled>Previous</button>
              <button class="pagination-btn" id="history-next-btn" disabled>Next</button>
            </div>
          </div>
        </div>
      </div>

      <!-- Templates Tab -->
      <div id="tab-templates" class="tab-pane">
        <header class="section-header" style="display: flex; justify-content: space-between; align-items: center;">
          <h2>Scraping Templates</h2>
          <button class="btn-secondary" id="save-current-as-template-btn">
            <span class="material-symbols-outlined" style="font-size: 16px; margin-right: 4px;">add</span>
            Save Current
          </button>
        </header>

        <!-- Template Suggestion Banner (hidden by default) -->
        <div id="template-suggestion-banner" class="template-suggestion-banner" style="display: none; background: var(--color-accent-light); border: 1px solid var(--color-accent); border-radius: 8px; padding: 12px; margin-bottom: 16px;">
          <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
            <span class="material-symbols-outlined" style="color: var(--color-accent);">lightbulb</span>
            <strong>Template Found!</strong>
          </div>
          <p id="template-suggestion-text" style="font-size: 13px; margin-bottom: 8px;">A saved template matches this page.</p>
          <div style="display: flex; gap: 8px;">
            <button class="btn-primary" id="apply-suggested-template-btn" style="font-size: 12px; padding: 6px 12px;">
              Apply Template
            </button>
            <button class="btn-text" id="dismiss-template-suggestion-btn" style="font-size: 12px;">
              Dismiss
            </button>
          </div>
        </div>

        <!-- Templates List -->
        <div class="option-card">
          <h3>Saved Templates</h3>
          <div id="templates-list" class="templates-list custom-scrollbar" style="max-height: 400px; overflow-y: auto;">
            <div class="templates-empty" style="text-align: center; padding: 32px; color: var(--color-text-muted);">
              <span class="material-symbols-outlined" style="font-size: 48px; display: block; margin-bottom: 8px;">content_copy</span>
              <p style="margin-bottom: 8px;">No templates saved yet.</p>
              <p style="font-size: 12px;">Configure a scraping task and click "Save Current" to create a reusable template.</p>
            </div>
          </div>
        </div>

        <!-- Template Info Card -->
        <div class="option-card" style="margin-top: 16px;">
          <h3>How Templates Work</h3>
          <div style="font-size: 13px; color: var(--color-text-muted);">
            <p style="margin-bottom: 8px;"><strong>1. Configure once:</strong> Set up pattern detection and extraction fields for a site.</p>
            <p style="margin-bottom: 8px;"><strong>2. Save template:</strong> Click "Save Current" to store your configuration.</p>
            <p style="margin-bottom: 8px;"><strong>3. Auto-detect:</strong> When you visit a matching URL, we'll suggest applying the template.</p>
            <p><strong>4. One-click apply:</strong> Instantly load your saved configuration.</p>
          </div>
        </div>
      </div>

      <!-- Settings Tab -->
      <div id="tab-settings" class="tab-pane">
        <header class="section-header">
          <h2>Settings</h2>
        </header>

        <div class="option-card">
          <h3>General</h3>
          <div class="option-row">
            <span>Dark Mode</span>
            <label class="switch">
              <input type="checkbox" id="dark-mode" checked>
              <span class="slider"></span>
            </label>
          </div>
          <div class="option-row">
            <span>Show Notifications</span>
            <label class="switch">
              <input type="checkbox" id="show-notifications" checked>
              <span class="slider"></span>
            </label>
          </div>
        </div>

        <div class="option-card">
          <h3>Export Defaults</h3>
          <div class="input-group">
            <label>Default Format</label>
            <select id="default-format" class="form-select" style="height: 40px;">
              <option value="json">JSON</option>
              <option value="csv">CSV</option>
              <option value="excel">Excel</option>
            </select>
          </div>
        </div>

        <div class="option-card">
          <h3>Webhooks & Integrations</h3>
          <div class="input-group">
            <label>Webhook URL</label>
            <input type="text" id="webhook-url" placeholder="https://your-webhook.com/endpoint">
          </div>
          <div class="option-row">
            <span>Send on task completion</span>
            <label class="switch">
              <input type="checkbox" id="webhook-on-complete">
              <span class="slider"></span>
            </label>
          </div>
          <div class="option-row">
            <span>Send on task failure</span>
            <label class="switch">
              <input type="checkbox" id="webhook-on-failure" checked>
              <span class="slider"></span>
            </label>
          </div>
          <div class="option-row">
            <span>Include extracted data</span>
            <label class="switch">
              <input type="checkbox" id="webhook-include-data">
              <span class="slider"></span>
            </label>
          </div>
          <div style="margin-top: 12px;">
            <button id="test-webhook-btn" class="btn-secondary" style="width: 100%;">
              <span class="material-symbols-outlined" style="font-size: 16px; margin-right: 4px;">send</span>
              Test Webhook
            </button>
          </div>
        </div>

        <div class="option-card">
          <h3>About</h3>
          <p style="font-size: 12px; color: var(--color-text-muted);">
            Scraper Pro v2.0<br>
            Built with Tailwind CSS
          </p>
        </div>
      </div>

    </main>
  </div>

  <!-- Task Creation Wizard Modal -->
  <div class="wizard-overlay" id="wizard-overlay">
    <div class="wizard-modal">
      <div class="wizard-sidebar">
        <div class="wizard-step active" data-step="1">
          <span class="wizard-step-number">1</span>
          <span>General</span>
        </div>
        <div class="wizard-step" data-step="2">
          <span class="wizard-step-number">2</span>
          <span>Schedule</span>
        </div>
        <div class="wizard-step" data-step="3">
          <span class="wizard-step-number">3</span>
          <span>Export</span>
        </div>
      </div>
      <div class="wizard-content">
        <!-- Step 1: General -->
        <div class="wizard-step-content active" id="wizard-step-1">
          <div class="wizard-header">
            <h2>General Setup</h2>
            <p>Configure the basic settings for your scraping task.</p>
          </div>
          <div class="wizard-body">
            <div class="form-field">
              <label class="form-label">Task Name</label>
              <input type="text" class="form-input" id="wizard-task-name" placeholder="My Scraping Task">
            </div>
            <!-- Quick Pick from Saved URLs -->
            <div class="form-field" id="wizard-saved-urls-picker">
              <label class="form-label">Quick Pick from Saved URLs</label>
              <select class="form-select" id="wizard-url-select" style="width: 100%; padding: 8px; border: 1px solid var(--color-border); border-radius: 6px; background: var(--color-bg); font-size: 13px;">
                <option value="">-- Select a saved URL (or enter manually below) --</option>
              </select>
              <span class="form-hint" style="font-size: 11px; color: var(--color-text-muted); margin-top: 4px; display: block;">
                Select a URL to auto-fill, or enter manually below
              </span>
            </div>
            <div class="form-field">
              <label class="form-label">Target URL(s)</label>
              <textarea class="form-textarea" id="wizard-target-urls" rows="3"
                placeholder="https://example.com/page1&#10;https://example.com/page2&#10;(one URL per line for batch scraping)"></textarea>
              <span class="form-hint" style="font-size: 11px; color: var(--color-text-muted); margin-top: 4px; display: block;">
                Enter one URL per line for batch scraping
              </span>
            </div>
            <!-- Batch options (shown when multiple URLs) -->
            <div class="form-field" id="batch-options" style="display: none;">
              <label class="form-label">Batch Options</label>
              <div class="option-row" style="padding: 8px 0;">
                <span style="font-size: 13px;">Continue on error</span>
                <label class="switch">
                  <input type="checkbox" id="wizard-continue-on-error" checked>
                  <span class="slider"></span>
                </label>
              </div>
              <div class="input-group" style="margin-top: 8px;">
                <label style="font-size: 12px;">Delay between URLs (ms)</label>
                <input type="number" class="form-input" id="wizard-batch-delay" value="2000" min="500" style="margin-top: 4px;">
              </div>
            </div>
            <div class="form-field">
              <label class="form-label">Description (optional)</label>
              <textarea class="form-textarea" id="wizard-description" placeholder="What does this task do?"></textarea>
            </div>
          </div>
        </div>

        <!-- Step 2: Schedule -->
        <div class="wizard-step-content" id="wizard-step-2">
          <div class="wizard-header">
            <h2>Schedule</h2>
            <p>Set when and how often this task should run.</p>
          </div>
          <div class="wizard-body">
            <div class="form-field">
              <label class="form-label">Frequency</label>
              <select class="form-select" id="wizard-frequency">
                <option value="once">Run Once</option>
                <option value="hourly">Every Hour</option>
                <option value="daily">Daily</option>
                <option value="weekly">Weekly</option>
                <option value="monthly">Monthly</option>
              </select>
            </div>
            <!-- Cron time picker (shown for daily/weekly/monthly) -->
            <div class="form-field" id="cron-time-field" style="display: none;">
              <label class="form-label">Run at Time</label>
              <input type="time" class="form-input" id="wizard-cron-time" value="09:00">
            </div>
            <!-- Day of week checkboxes (shown for weekly) -->
            <div class="form-field" id="cron-days-field" style="display: none;">
              <label class="form-label">Run on Days</label>
              <div class="checkbox-group" id="wizard-days-group" style="display: flex; flex-wrap: wrap; gap: 8px; margin-top: 8px;">
                <label style="display: flex; align-items: center; gap: 4px; font-size: 13px; cursor: pointer;">
                  <input type="checkbox" value="1" style="width: 16px; height: 16px;"> Mon
                </label>
                <label style="display: flex; align-items: center; gap: 4px; font-size: 13px; cursor: pointer;">
                  <input type="checkbox" value="2" style="width: 16px; height: 16px;"> Tue
                </label>
                <label style="display: flex; align-items: center; gap: 4px; font-size: 13px; cursor: pointer;">
                  <input type="checkbox" value="3" style="width: 16px; height: 16px;"> Wed
                </label>
                <label style="display: flex; align-items: center; gap: 4px; font-size: 13px; cursor: pointer;">
                  <input type="checkbox" value="4" style="width: 16px; height: 16px;"> Thu
                </label>
                <label style="display: flex; align-items: center; gap: 4px; font-size: 13px; cursor: pointer;">
                  <input type="checkbox" value="5" style="width: 16px; height: 16px;"> Fri
                </label>
                <label style="display: flex; align-items: center; gap: 4px; font-size: 13px; cursor: pointer;">
                  <input type="checkbox" value="6" style="width: 16px; height: 16px;"> Sat
                </label>
                <label style="display: flex; align-items: center; gap: 4px; font-size: 13px; cursor: pointer;">
                  <input type="checkbox" value="0" style="width: 16px; height: 16px;"> Sun
                </label>
              </div>
            </div>
            <!-- Day of month input (shown for monthly) -->
            <div class="form-field" id="cron-month-days-field" style="display: none;">
              <label class="form-label">Run on Day(s) of Month</label>
              <input type="text" class="form-input" id="wizard-month-days" placeholder="1, 15 (comma-separated)">
              <span class="form-hint" style="font-size: 11px; color: var(--color-text-muted); margin-top: 4px; display: block;">
                Enter day numbers (1-31), comma-separated
              </span>
            </div>
            <div class="form-field">
              <label class="form-label">Max Items to Collect</label>
              <input type="number" class="form-input" id="wizard-max-items" value="100" min="1">
            </div>
            <div class="form-field">
              <label class="form-label">Timeout (seconds)</label>
              <input type="number" class="form-input" id="wizard-timeout" value="300" min="30">
            </div>
          </div>
        </div>

        <!-- Step 3: Export -->
        <div class="wizard-step-content" id="wizard-step-3">
          <div class="wizard-header">
            <h2>Export & Integration</h2>
            <p>Configure how data should be exported.</p>
          </div>
          <div class="wizard-body">
            <div class="form-field">
              <label class="form-label">Export Format</label>
              <select class="form-select" id="wizard-export-format">
                <option value="json">JSON</option>
                <option value="csv">CSV</option>
                <option value="excel">Excel</option>
              </select>
            </div>
            <div class="form-field">
              <label class="form-label">Webhook URL (optional)</label>
              <input type="text" class="form-input" id="wizard-webhook" placeholder="https://your-webhook.com/endpoint">
            </div>
            <div class="option-row" style="padding: 12px 0;">
              <span style="font-size: 14px;">Auto-export on completion</span>
              <label class="switch">
                <input type="checkbox" id="wizard-auto-export">
                <span class="slider"></span>
              </label>
            </div>
            <!-- Change Detection Section -->
            <div style="border-top: 1px solid var(--color-border); margin-top: 12px; padding-top: 12px;">
              <label class="form-label" style="margin-bottom: 8px;">Change Detection</label>
              <div class="option-row" style="padding: 8px 0;">
                <span style="font-size: 14px;">Enable change detection</span>
                <label class="switch">
                  <input type="checkbox" id="wizard-change-detection">
                  <span class="slider"></span>
                </label>
              </div>
              <div class="option-row" id="webhook-on-change-row" style="padding: 8px 0; display: none;">
                <span style="font-size: 14px;">Webhook only on changes</span>
                <label class="switch">
                  <input type="checkbox" id="wizard-webhook-on-change">
                  <span class="slider"></span>
                </label>
              </div>
              <span class="form-hint" style="font-size: 11px; color: var(--color-text-muted); display: block; margin-top: 4px;">
                Detect when scraped data has changed since last run
              </span>
            </div>
          </div>
        </div>

        <div class="wizard-footer">
          <button class="btn-secondary" id="wizard-cancel-btn">Cancel</button>
          <div style="display: flex; gap: 8px;">
            <button class="btn-secondary" id="wizard-prev-btn" style="display: none;">
              <span class="material-symbols-outlined" style="font-size: 16px;">arrow_back</span>
              Back
            </button>
            <button class="btn-primary" id="wizard-next-btn" style="width: auto; padding: 0 20px;">
              Next
              <span class="material-symbols-outlined" style="font-size: 16px;">arrow_forward</span>
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script type="module" src="./sidepanel.ts"></script>
</body>

</html>