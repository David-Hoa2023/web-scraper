# Research: Claude Code Data Analysis and Visualization Skills

> Generated by /research on 2026-01-28
> Target Project: D:\AI_project\web-scraper

## Executive Summary

Claude Code provides powerful built-in data analysis and visualization capabilities through its code execution tool and custom skills system. For Excel file handling in your web-scraper project, the recommended approach is to use the **xlsx skill** combined with Claude Code's native Jupyter notebook integration.

## Research Scope

- **Query**: Claude Code data analysis and visualization skills for Excel files
- **Sources Searched**: Anthropic docs, Claude plugins registry, GitHub skills repositories
- **Focus**: Claude Code-specific skills (not general JS libraries)

---

## Key Findings

### 1. Claude Code's Built-in Analysis Tool

Claude Code includes a **code execution tool** that turns Claude from a code-writing assistant into a full data analyst.

**Capabilities:**
- Run Python code directly within conversations
- Create visualizations (matplotlib, seaborn, plotly)
- Analyze data with pandas, numpy, scipy, scikit-learn
- Generate downloadable files (Excel, CSV, reports)
- Handle complex multi-step workflows

**Pre-installed Libraries:**
| Category | Libraries |
|----------|-----------|
| Data Science | pandas, numpy, scipy, scikit-learn, statsmodels |
| Visualization | matplotlib, seaborn |
| File Processing | **openpyxl**, **xlsxwriter**, pyarrow, pillow, python-pptx, python-docx, pypdf |
| Math | sympy, mpmath |

**Source:** [Code execution tool - Claude Docs](https://docs.claude.com/en/docs/agents-and-tools/tool-use/code-execution-tool)

---

### 2. xlsx Skill (Recommended for Your Project)

The **xlsx skill** is the primary Claude Code skill for Excel data analysis and visualization.

**Installation:**
1. Download from [claude-plugins.dev/skills/@szweibel/claude-skills/xlsx](https://claude-plugins.dev/skills/@szweibel/claude-skills/xlsx)
2. Go to `claude.ai/settings/capabilities` → "Skills" section
3. Click "Upload skill" and select the ZIP file

**Capabilities:**
- Create new spreadsheets with formulas and formatting
- Read and analyze existing Excel data
- Modify spreadsheets while preserving formulas
- Data analysis and visualization in spreadsheets
- Recalculate formulas with error detection

**Key Features:**
- Uses **pandas** for data manipulation and statistical analysis
- Uses **openpyxl** to preserve existing formulas and formatting
- Built-in error scanning (#REF!, #DIV/0!, etc.)
- Financial modeling standards (color coding, number formatting)

**Source:** [xlsx - Skills - Claude Code Plugins](https://claude-plugins.dev/skills/@szweibel/claude-skills/xlsx)

---

### 3. Excel Skill (Alternative)

Another option is the **excel skill** from Fergana-Labs.

**Source:** [excel - Claude Skills](https://claude-plugins.dev/skills/@Fergana-Labs/claude_agent_desktop/excel)

---

### 4. Creating a Custom Data Analysis Skill

You can create a custom skill tailored to your web-scraper's data export needs.

**Skill Structure:**
```
data-analysis-skill/
├── SKILL.md              # Required: Instructions for Claude
├── scripts/
│   ├── analyze.py        # Data analysis functions
│   └── visualize.py      # Chart generation
└── templates/
    └── report.xlsx       # Excel template
```

**Example SKILL.md:**
```markdown
---
name: scraper-data-analysis
description: Analyzes scraped web data and exports to Excel with visualizations.
Use when the user wants to analyze scraped data, create reports, or export to Excel.
---

## Instructions

When analyzing scraped data:

1. **Load Data**: Read JSON/CSV from scraper output
2. **Clean Data**: Handle missing values, normalize formats
3. **Analyze**: Generate statistics, find patterns
4. **Visualize**: Create charts using matplotlib/seaborn
5. **Export**: Save to Excel with formatting using openpyxl

## Code Patterns

### Load Scraped Data
```python
import pandas as pd
df = pd.read_json('scraped_data.json')
```

### Create Excel with Charts
```python
from openpyxl import Workbook
from openpyxl.chart import BarChart, Reference

wb = Workbook()
ws = wb.active

# Add data
for row in data:
    ws.append(row)

# Create chart
chart = BarChart()
data_ref = Reference(ws, min_col=2, min_row=1, max_row=10)
chart.add_data(data_ref)
ws.add_chart(chart, "E2")

wb.save('report.xlsx')
```

## Output Requirements
- All Excel files must have zero formula errors
- Include summary statistics sheet
- Charts should be properly labeled
```

**Source:** [Skills README - Anthropic Claude Cookbooks](https://github.com/anthropics/claude-cookbooks/blob/main/skills/README.md)

---

### 5. Claude Code + Jupyter Notebook Workflow

For advanced data analysis, use Claude Code with Jupyter notebooks in VS Code.

**Workflow:**
1. Open VS Code with Jupyter extension
2. Create `.ipynb` notebook for analysis
3. Use Claude Code to write analysis code
4. Claude can read notebook outputs including charts
5. Export results to Excel

**Benefits:**
- Real-time code execution and refinement
- Visual feedback on charts and tables
- Iterative analysis with intermediate results
- 2-4x time savings for data science teams

**Source:** [How Anthropic teams use Claude Code (PDF)](https://www-cdn.anthropic.com/58284b19e702b49db9302d5b6f135ad8871e7658.pdf)

---

## Action Items for web-scraper Project

### High Priority (Immediate Integration)

- [ ] **Install xlsx skill** - Download and add to Claude Code for Excel export capability
- [ ] **Add openpyxl dependency** - `bun add openpyxl` (for Python scripts) or use ExcelJS for TypeScript
- [ ] **Create `src/export/excelExporter.ts`** - Module to convert scraped `ExtractedItem[]` to Excel

### Medium Priority (Enhanced Features)

- [ ] **Create custom skill** - Build `scraper-data-analysis` skill in `.claude/skills/` folder
- [ ] **Add visualization support** - Integrate Chart.js for generating chart images to embed in Excel
- [ ] **Add data analysis module** - Use Arquero or simple-statistics for aggregations

### Low Priority (Future Enhancement)

- [ ] **Build analysis dashboard** - React component for previewing data before export
- [ ] **Add pivot table support** - Use PivotTable.js for interactive data exploration

---

## Recommended Implementation

### Option A: Use xlsx Skill Directly (Fastest)

1. Install the xlsx skill from claude-plugins.dev
2. When user exports data, invoke Claude with: "Create an Excel report from this scraped data with summary statistics and a chart"
3. Claude generates the Excel file using the skill

### Option B: Custom Integration (More Control)

Add ExcelJS to your web-scraper for programmatic Excel generation:

```typescript
// src/export/excelExporter.ts
import ExcelJS from 'exceljs';
import type { ExtractedItem } from '../types';

export async function exportToExcel(
  items: ExtractedItem[],
  filename: string
): Promise<Blob> {
  const workbook = new ExcelJS.Workbook();
  const sheet = workbook.addWorksheet('Scraped Data');

  // Add headers from first item keys
  if (items.length > 0) {
    const headers = Object.keys(items[0]);
    sheet.addRow(headers);

    // Style headers
    sheet.getRow(1).font = { bold: true };
    sheet.getRow(1).fill = {
      type: 'pattern',
      pattern: 'solid',
      fgColor: { argb: 'FFE0E0E0' }
    };

    // Add data rows
    items.forEach(item => {
      sheet.addRow(Object.values(item));
    });

    // Auto-fit columns
    sheet.columns.forEach(col => {
      col.width = 15;
    });
  }

  // Generate blob for download
  const buffer = await workbook.xlsx.writeBuffer();
  return new Blob([buffer], {
    type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'
  });
}
```

### Option C: Hybrid Approach (Recommended)

1. Use ExcelJS for basic data export (fast, programmatic)
2. Use Claude Code xlsx skill for advanced analysis requests
3. Create custom skill for project-specific report templates

---

## Sources

- [Introducing the analysis tool in Claude.ai](https://www.anthropic.com/news/analysis-tool)
- [Code execution tool - Claude Docs](https://docs.claude.com/en/docs/agents-and-tools/tool-use/code-execution-tool)
- [xlsx - Skills - Claude Code Plugins](https://claude-plugins.dev/skills/@szweibel/claude-skills/xlsx)
- [Skills README - Anthropic Claude Cookbooks](https://github.com/anthropics/claude-cookbooks/blob/main/skills/README.md)
- [awesome-claude-skills - GitHub](https://github.com/travisvn/awesome-claude-skills)
- [Using Skills in Claude - Help Center](https://support.claude.com/en/articles/12512180-using-skills-in-claude)
- [How do I use Claude Code for data analysis?](https://milvus.io/ai-quick-reference/how-do-i-use-claude-code-for-data-analysis)
- [Claude for data analysis - Data Studios](https://www.datastudios.org/post/claude-for-data-analysis-how-anthropic-s-assistant-handles-files-charts-code-and-context)

---

## L60-L77.5 Alignment Evaluation

| Level | Check | Status |
|-------|-------|--------|
| L62 | Parallel agent spawn | PASS (4 agents) |
| L68 | Source routing correct | PASS |
| L73 | Findings deduplicated | PASS |
| L74 | Behavioral alignment | PASS |

### Alignment Score: 100%
